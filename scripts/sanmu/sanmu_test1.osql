CREATE TABLE `test1` (
  `NAME` varchar(200) DEFAULT NULL COMMENT '表名',
  `A` varchar(200) DEFAULT NULL COMMENT '字段名',
  `B` text COMMENT '字段类型',
  `C` text COMMENT '字段注释',
  `XXX` text COMMENT '表备注'
) ENGINE=InnoDB AUTO_INCREMENT=178 DEFAULT CHARSET=utf8;

show variables like 'group_concat_max_len';

-- SET GLOBAL group_concat_max_len = 2048;
SET SESSION group_concat_max_len = 10240;

--  NAME 表名  A 字段名  B 字段类型 C 字段注释  XXX 表备注
SELECT
concat_ws('',
'create table if not exists ods_',NAME,'(',
GROUP_CONCAT(
concat_ws('',
A,' ',
CASE

WHEN INSTR( B, 'int' ) THEN
'bigint'
WHEN INSTR( B, 'char' ) THEN
'string'
WHEN INSTR( B, 'time' ) THEN
'string'
WHEN INSTR( B, 'text' ) THEN
'string'
WHEN INSTR( B, 'text' ) THEN
'string'
WHEN INSTR( B, 'numeric' ) THEN
'double'
END ,
' comment \'',C,'\''
)
) , ') \ncomment \'', XXX, '\' partitioned by(ds string comment \'时间分区\');'
)
FROM
test1
-- WHERE
-- 	NAME = 'order_shipping_info' 
GROUP BY
NAME,XXX;




	