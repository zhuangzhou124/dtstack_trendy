SELECT t2.sales_order_no,
			 t2.order_amt,
			 t2.cash_amt
FROM (
	SELECT soi.sales_order_no,
				 sum(soi.price_sales * soi.qty_product) AS order_amt,
				 sum(osoip.amt_cash_coupon_contribution) AS cash_amt
	FROM (
		SELECT sales_order_no,
					 sales_order_item_no,
					 price_sales,
					 qty_product
		FROM ods_sales_order_item
		WHERE ds = '${bizdate}') soi
		INNER JOIN (
			SELECT sales_order_item_no,
						 amt_cash_coupon_contribution
			FROM ods_sales_order_item_price
			WHERE ds = '${bizdate}') osoip
			ON osoip.sales_order_item_no = soi.sales_order_item_no
	GROUP BY soi.sales_order_no) AS t2;

